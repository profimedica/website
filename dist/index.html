<!DOCTYPE html>
<html lang="en-US">
<head>
    <title>Veterinary Medicine Information Exchange</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script
    src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
    crossorigin="anonymous"></script>
    <script src="./lib/vue/vue.js" asp-append-version="true"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./lib/css/theme.css">
    <!-- theme -->
    <meta property="og:title" content="Veterinary Medicine Information Exchange" />
    <meta property="og:locale" content="en_US" />
    <meta name="description" content="Open standards in Veterinary Medicine Information Exchange" />
    <meta property="og:description" content="Open standards in Veterinary Medicine Information Exchange" />
    <link rel="canonical" href="https://vmie.org" />
    <meta property="og:url" content="https://vmie.org" />
    <meta property="og:site_name" content="Veterinary Medicine Information Exchange" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Veterinary Medicine Information Exchange" />
    <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"WebSite","description":"Leap Day is a theme for GitHub Pages.","headline":"Leap Day theme","name":"Leap Day theme","url":"https://pages-themes.github.io/leap-day/"}</script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
      
</head>
<body>
    <div id="app">
        <header>
            <h1>Veterinary Medicine Information Exchange</h1>
            <p>Non-Profit Organization for providing standards on vmie.org</p>
          </header>
          
      <!-- banner start -->
      <div id="banner">
        <span id="logo"></span>
        <a v-if="!isMobile" href="https://github.com/vmie-org/website" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads" v-if="!isMobile">
            <span>Free:</span>
            <ul>
                <li><a href="./poc" class="button">Tools</a></li>
            </ul>
          </div><div v-if="isMobile">
            <ul>
                <li v-for="(page, index) in websitePages" v-if="index > 0" :class="page.isSelected ? 'tag-h1 active' : 'tag-h2'" @click="renderPage(page)"><a class="button" :href="'?page=' + page.id + '#' + page.id">{{page.id}}</a></li>
            </ul>
          </div>
      </div>
      <!-- banner end -->

    <div class="wrapper">
        <nav>
            <ul>
                <li v-for="page in websitePages" :class="page.isSelected ? 'tag-h1 active' : 'tag-h2'" @click="renderPage(page)"><a :href="'?page=' + page.id + '#' + page.id">{{page.title}}</a></li>
            </ul>
        </nav>
        <section style="height: auto;">
            <p v-if="htmlContent" v-html="htmlContent"></p>
        </section>
    </div>
    <footer>
      
        <p>
            <div><small>Source available on <a href="https://github.com/vmie-org/website">GitHub</a></small></div>
            <div><small>Hosted on <a href="https://vmie.org">vmie.org</a></small></div>
        </p>
    </footer>
  </div>
</body>
</html>

<script>


    
var apiService = {
		jwt: null,
		postData(url, payload, handler){
			var context = this;
			$.ajax({
				headers: {
					"Authorization": "Bearer "  + this.jwt,
				},
				url: url,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				type: "POST",
				data: JSON.stringify(payload)
			}).done(function (data) {
				handler(data);
			}).fail(function (data) {
			});
		},
		getData(url, handler){
			var context = this;
			$.ajax({
				headers: {
					"Authorization": "Bearer "  + this.jwt,
				},
				url: url,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				type: "GET"
			}).done(function (data) {
				handler(data);
			}).fail(function (data) {
			});
		},
		getText(url, handler){
			var context = this;
			$.ajax({
				headers: {
					"Authorization": "Bearer "  + this.jwt,
				},
				url: url,
				contentType: "application/text; charset=utf-8",
                dataType: "text",
				type: "GET"
			}).done(function (data) {
				handler(data);
			}).fail(function (data) {
			});
		}
	};

	var userService = {
		apiService: apiService,
		loginUser(user, loginUserHandler){
		},
	};

    var app = new Vue({
        el: '#app',
        data: {
            isMobile: true,
            apiService: apiService,
            htmlContent: null,
            websitePages: [
                {
                    id: "Welcome",
                    title: "Our Mission",
                    url: "./content/index.txt",
                    isSelected: false,
                },
                {
                    id: "Compatibility",
                    title: "Compatibility check",
                    url: "./content/compatibility.txt",
                    isSelected: false,
                },
                {
                    id: "Security",
                    title: "Information and Security",
                    url: "./content/security.txt",
                    isSelected: false,
                },
                {
                    id: "Architecture",
                    title: "Software Architecture",
                    url: "./content/architecture.txt",
                    isSelected: false,
                },
            ],
        },
        mounted: function () {
            let page = this.websitePages[0];
            let pageId = location.hash;
            if(pageId){
                let hrefPage = this.websitePages.find(p=> "#" + p.id == pageId);
                if(hrefPage){
                    page = hrefPage;
                }
            }
            this.renderPage(page);
        },
        computed: {
        },
        methods: {
            renderPage(page){
                this.websitePages.forEach(page => {
                    page.isSelected = false;
                });
                apiService.getText(page.url, this.parseContent);
                page.isSelected = true;
            },
            parseContent(content){
                let lines = content.split('\n');

                lines = lines.map(line => line.trim());
                var tableBuilder = null;

                this.htmlContent = lines.map(line => {

                    if(!line.length){
                        if(tableBuilder){
                            var table = tableBuilder + "</table></p><p>";
                            tableBuilder = null;
                            return table;
                        }
                        return "</p><p>";
                    }

                    if(line.indexOf('#### ') === 0){
                        return `<h4>${line.substring(5)}</h4>`;
                    }
                    if(line.indexOf('### ') === 0){
                        return `<h3>${line.substring(4)}</h3>`;
                    }
                    else if(line.indexOf('## ') === 0){
                        return `<h2>${line.substring(3)}</h2>`;
                    }
                    else if(line.indexOf('# ') === 0){
                        return `<h1>${line.substring(2)}</h1>`;
                    }
                    else if(line.indexOf('![') === 0){
                        let img = line.substring(line.indexOf('(')+1);
                        let imgSource = img.split(' ')[0];
                        let imgAlt = img.substring(imgSource.length + 2);
                        imgAlt = imgAlt.substring(0, imgAlt.length-2);
                        return `<center style='color: silver; border: 1px solid #ddd'><img src='${imgSource}' alt='${imgAlt}' /><br>${imgAlt}</center>`;
                    }
                    if(line.indexOf('***') >= 0){
                        line = line.replace(/\*\*\*(.*?)\*\*\*/g, '<b><i>$1</i></b>')
                    }
                    else if(line.indexOf('**') >= 0){
                        line = line.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')
                    }
                 
                    if(line.indexOf('| ') === 0 && line.lastIndexOf(' |') == line.length-2){
                        if(!tableBuilder){
                            tableBuilder = "<table>";
                        }
                        tableBuilder += "<tr><td>" + line.substring(1, line.length-3).split(" | ").join("</td><td>") + "</td></tr>";
                        return null;
                    }

                    if(line.indexOf('-----------') == 0){
                        return '<hr>';
                    }
                    return `${line}<br/>`;
                }).join('');
            },
		}
    });

</script>
</style>
